# $NetBSD$

PKGNAME=	task-3.0.0
DISTNAME=	task-${GITHUB_TAG}
CATEGORIES=	devel
MASTER_SITES=	${MASTER_SITE_GITHUB:=go-task/}
GITHUB_PROJECT=	task
GITHUB_TAG=	v${PKGVERSION_NOREV}

MAINTAINER=	iku.iwasa@gmail.com
HOMEPAGE=	https://taskfile.dev/
COMMENT=	Task-runner / simpler Make alternative written in Go
LICENSE=	mit

EXTRACT_USING=	bsdtar

GO_MODULE_FILES+=	github.com/creack/pty/@v/v1.1.9.mod
GO_MODULE_FILES+=	github.com/creack/pty/@v/v1.1.9.zip
GO_MODULE_FILES+=	github.com/davecgh/go-spew/@v/v1.1.0.mod
GO_MODULE_FILES+=	github.com/davecgh/go-spew/@v/v1.1.1.mod
GO_MODULE_FILES+=	github.com/davecgh/go-spew/@v/v1.1.1.zip
GO_MODULE_FILES+=	github.com/fatih/color/@v/v1.7.0.mod
GO_MODULE_FILES+=	github.com/fatih/color/@v/v1.7.0.zip
GO_MODULE_FILES+=	github.com/go-task/slim-sprig/@v/v0.0.0-20200516131648-f9bac4e523eb.mod
GO_MODULE_FILES+=	github.com/go-task/slim-sprig/@v/v0.0.0-20200516131648-f9bac4e523eb.zip
GO_MODULE_FILES+=	github.com/google/renameio/@v/v0.1.0.mod
GO_MODULE_FILES+=	github.com/google/renameio/@v/v0.1.0.zip
GO_MODULE_FILES+=	github.com/joho/godotenv/@v/v1.3.0.mod
GO_MODULE_FILES+=	github.com/joho/godotenv/@v/v1.3.0.zip
GO_MODULE_FILES+=	github.com/kr/pretty/@v/v0.1.0.mod
GO_MODULE_FILES+=	github.com/kr/pretty/@v/v0.2.0.mod
GO_MODULE_FILES+=	github.com/kr/pretty/@v/v0.2.0.zip
GO_MODULE_FILES+=	github.com/kr/pty/@v/v1.1.1.mod
GO_MODULE_FILES+=	github.com/kr/pty/@v/v1.1.1.zip
GO_MODULE_FILES+=	github.com/kr/text/@v/v0.1.0.mod
GO_MODULE_FILES+=	github.com/kr/text/@v/v0.2.0.mod
GO_MODULE_FILES+=	github.com/kr/text/@v/v0.2.0.zip
GO_MODULE_FILES+=	github.com/mattn/go-colorable/@v/v0.1.2.mod
GO_MODULE_FILES+=	github.com/mattn/go-colorable/@v/v0.1.2.zip
GO_MODULE_FILES+=	github.com/mattn/go-isatty/@v/v0.0.8.mod
GO_MODULE_FILES+=	github.com/mattn/go-isatty/@v/v0.0.8.zip
GO_MODULE_FILES+=	github.com/mattn/go-zglob/@v/v0.0.1.mod
GO_MODULE_FILES+=	github.com/mattn/go-zglob/@v/v0.0.1.zip
GO_MODULE_FILES+=	github.com/pkg/diff/@v/v0.0.0-20190930165518-531926345625.mod
GO_MODULE_FILES+=	github.com/pkg/diff/@v/v0.0.0-20190930165518-531926345625.zip
GO_MODULE_FILES+=	github.com/pmezard/go-difflib/@v/v1.0.0.mod
GO_MODULE_FILES+=	github.com/pmezard/go-difflib/@v/v1.0.0.zip
GO_MODULE_FILES+=	github.com/radovskyb/watcher/@v/v1.0.5.mod
GO_MODULE_FILES+=	github.com/radovskyb/watcher/@v/v1.0.5.zip
GO_MODULE_FILES+=	github.com/rogpeppe/go-internal/@v/v1.5.2.mod
GO_MODULE_FILES+=	github.com/rogpeppe/go-internal/@v/v1.5.2.zip
GO_MODULE_FILES+=	github.com/sergi/go-diff/@v/v1.0.0.mod
GO_MODULE_FILES+=	github.com/sergi/go-diff/@v/v1.0.0.zip
GO_MODULE_FILES+=	github.com/spf13/pflag/@v/v1.0.3.mod
GO_MODULE_FILES+=	github.com/spf13/pflag/@v/v1.0.3.zip
GO_MODULE_FILES+=	github.com/stretchr/objx/@v/v0.1.0.mod
GO_MODULE_FILES+=	github.com/stretchr/objx/@v/v0.1.0.zip
GO_MODULE_FILES+=	github.com/stretchr/testify/@v/v1.4.0.mod
GO_MODULE_FILES+=	github.com/stretchr/testify/@v/v1.5.1.mod
GO_MODULE_FILES+=	github.com/stretchr/testify/@v/v1.5.1.zip
GO_MODULE_FILES+=	golang.org/x/sync/@v/v0.0.0-20190911185100-cd5d95a43a6e.mod
GO_MODULE_FILES+=	golang.org/x/sync/@v/v0.0.0-20190911185100-cd5d95a43a6e.zip
GO_MODULE_FILES+=	golang.org/x/sys/@v/v0.0.0-20190222072716-a9d3bda3a223.mod
GO_MODULE_FILES+=	golang.org/x/sys/@v/v0.0.0-20191026070338-33540a1f6037.mod
GO_MODULE_FILES+=	golang.org/x/sys/@v/v0.0.0-20200217220822-9197077df867.mod
GO_MODULE_FILES+=	golang.org/x/sys/@v/v0.0.0-20200217220822-9197077df867.zip
GO_MODULE_FILES+=	golang.org/x/term/@v/v0.0.0-20191110171634-ad39bd3f0407.mod
GO_MODULE_FILES+=	golang.org/x/term/@v/v0.0.0-20191110171634-ad39bd3f0407.zip
GO_MODULE_FILES+=	golang.org/x/xerrors/@v/v0.0.0-20191204190536-9bdfabe68543.mod
GO_MODULE_FILES+=	golang.org/x/xerrors/@v/v0.0.0-20191204190536-9bdfabe68543.zip
GO_MODULE_FILES+=	gopkg.in/check.v1/@v/v0.0.0-20161208181325-20d25e280405.mod
GO_MODULE_FILES+=	gopkg.in/check.v1/@v/v1.0.0-20180628173108-788fd7840127.mod
GO_MODULE_FILES+=	gopkg.in/check.v1/@v/v1.0.0-20190902080502-41f04d3bba15.mod
GO_MODULE_FILES+=	gopkg.in/check.v1/@v/v1.0.0-20190902080502-41f04d3bba15.zip
GO_MODULE_FILES+=	gopkg.in/errgo.v2/@v/v2.1.0.mod
GO_MODULE_FILES+=	gopkg.in/errgo.v2/@v/v2.1.0.zip
GO_MODULE_FILES+=	gopkg.in/yaml.v2/@v/v2.2.2.mod
GO_MODULE_FILES+=	gopkg.in/yaml.v2/@v/v2.2.2.zip
GO_MODULE_FILES+=	gopkg.in/yaml.v3/@v/v3.0.0-20200313102051-9f266ea9e77c.mod
GO_MODULE_FILES+=	gopkg.in/yaml.v3/@v/v3.0.0-20200313102051-9f266ea9e77c.zip
GO_MODULE_FILES+=	mvdan.cc/editorconfig/@v/v0.1.1-0.20200121172147-e40951bde157.mod
GO_MODULE_FILES+=	mvdan.cc/editorconfig/@v/v0.1.1-0.20200121172147-e40951bde157.zip
GO_MODULE_FILES+=	mvdan.cc/sh/v3/@v/v3.1.2.mod
GO_MODULE_FILES+=	mvdan.cc/sh/v3/@v/v3.1.2.zip

GO_BUILD_PATTERN=	./cmd/task
CHECK_RELRO_SKIP+=	bin/task

INSTALLATION_DIRS+=	bin \
			share/bash-completion/completions \
			share/zsh/site-functions

do-build:
	${RUN}${_ULIMIT_CMD} cd ${WRKSRC} && ${PKGSRC_SETENV} ${MAKE_ENV} ${GO} install \
		-ldflags '-X main.version=${PKGVERSION_NOREV}' -v ${GO_BUILD_PATTERN}

do-install:
	${RUN} cd ${WRKDIR}/.gopath && [ ! -d bin ] || ${PAX} -rw bin ${DESTDIR}${PREFIX}
	${INSTALL_DATA} ${WRKSRC}/completion/bash/task.bash \
			${DESTDIR}${PREFIX}/share/bash-completion/completions/task
	${INSTALL_DATA} ${WRKSRC}/completion/zsh/_task \
			${DESTDIR}${PREFIX}/share/zsh/site-functions/_task

.include "../../lang/go/go-module.mk"
.include "../../mk/bsd.pkg.mk"
